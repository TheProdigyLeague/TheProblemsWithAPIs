# ╨Ш╨╜╤Д╤А╨░╤Б╤В╤А╤Г╨║╤В╤Г╤А╨░ ╨▒╤Л╤Б╤В╤А╨╛╨│╨╛ ╨╕╨╜╤В╨╡╤А╤Д╨╡╨╣╤Б╨░ ╨┐╤А╨╕╨║╨╗╨░╨┤╨╜╤Л╤Е ╨┐╤А╨╛╨│╤А╨░╨╝╨╝ЁЯФм
<a href="https://www.starlette.io/testclient/" class="external-link" target="_blank">starlette</a>
![starlette](https://github.com/TheProdigyLeague/TheProblemsWithAPIs/assets/30985576/896ea783-977f-48fa-9155-cfa1e8c51530)

<a href="https://www.python-httpx.org" class="external-link" target="_blank">pydantic</a>
![pydantic](https://github.com/TheProdigyLeague/TheProblemsWithAPIs/assets/30985576/c0a46f32-7af1-4eb9-8758-8bd25b57f402)

<a href="https://docs.pytest.org/" class="external-link" target="_blank">graphql</a>
![graphql](https://github.com/TheProdigyLeague/TheProblemsWithAPIs/assets/30985576/e1f590ce-206e-4b18-8156-aa0746a7ae0c)

я╝жя╜Бя╜Уя╜Фя╝бя╝░я╝йя╝Ия╜Гя╝Ия╝┤я╝ня╝Йя╝Й

## тЭФтЪУЁЯУиЁЯУ╢тЪЩя╕П `TestClient`

щЗНшжБчЪД

    тЪЩя╕П `TestClient`<a href="https://www.python-httpx.org" class="external-link" target="_blank">`httpx`</a>.

    тЪЩя╕П `pip install httpx`.

ЁЯЧД `TestClient` тЬН ╨Ч╨░╨┐╤Г╤Б╨║╨░╨╣╤В╨╡ ╤В╨╡╤Б╤В╨╛╨▓╤Л╨╣ ╨║╨╗╨╕╨╡╨╜╤В, ╨║╨╛╨│╨┤╨░ ╨┐╨╛╨╗╤М╨╖╨╛╨▓╨░╤В╨╡╨╗╤М ╤Г╤Б╤В╨░╨╜╨░╨▓╨╗╨╕╨▓╨░╨╡╤В ╨▒╤Л╤Б╤В╤А╤Л╨╣ ╨╕╨╜╤В╨╡╤А╤Д╨╡╨╣╤Б ╨┐╤А╨╕╨║╨╗╨░╨┤╨╜╨╛╨╣ ╨┐╤А╨╛╨│╤А╨░╨╝╨╝╤Л. ╨Ш╨╜╤Б╤В╤А╤Г╨║╤Ж╨╕╨╕ ╨╝╨╛╨╢╨╜╨╛ ╨╜╨░╨╣╤В╨╕ ╨▓ ╤А╨╡╨┐╨╛╨╖╨╕╤В╨╛╤А╨╕╤П╤Е. **я╝жя╜Бя╜Уя╜Фя╝бя╝░я╝йя╝Ия╜Гя╝Ия╝┤я╝ня╝Йя╝Й** ЁЯУЫ тЦ╢`test_` (ЁЯСЙ ЁЯРй `pytest` ЁЯПЫ). тЪЩя╕П `httpx`.

~~тЬН ЁЯЩЕ `assert` ЁЯУД тПоя╕П ЁЯРй ЁЯРН ЁЯзм ЁЯСИ ЁЯСЖ ЁЯТк тЬЕ (ЁЯФД, ЁЯРй `pytest`).~~

```Python hl_lines="2  12  15-18"
{!../../../docs_src/app_testing/tutorial001.py!}
```

щЗНшжБчЪД
f9fd318758d091299ffbfb3e32ddc69b

щЗНшжБчЪД "ЁЯУб тД╣"
    ЁЯСЖ ЁЯТк тЪЩя╕П `from starlette.testclient import TestClient`. ЁЯЪЪ ЁЯОП `starlette.testclient` `я╝жя╜Бя╜Уя╜Фя╝бя╝░я╝йя╝Ия╜Гя╝Ия╝┤я╝ня╝Йя╝Й.testclient` 30c7f5c546861b3fbbb5e60a31f09329

щЗНшжБчЪД
    ЁЯЪе `async` ЁЯСА [ЁЯФБ ЁЯТп](../advanced/async-tests.md){.internal-link target=_blank} ЁЯПзЁЯФ░ЁЯО░ЁЯИ╕ЁЯО▓ЁЯФЬтЬФя╕ПЁЯУБ.&amp;
    ![fastapi](https://github.com/TheProdigyLeague/TheProblemsWithAPIs/assets/30985576/4f98cb01-ffc8-4856-9c5d-5aca4918a002)
    ЁЯИ╕ЁЯУЖтЬНЁЯУЪЁЯУБЁЯХ╣ЁЯТмЁЯСЖтЬФя╕ПЁЯУБЁЯУКЁЯФм [fastapi](./bigger-applications.md){.internal-link target=_blank}:
    рддреЗрдЬрд╝ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкреНрд░реЛрдЧреНрд░рд╛рдо рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХреЗ рд╕рд╛рдеред рд╕рднреА рдирд┐рд░реНрднрд░рддрд╛рдПрдБ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдирд╛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдФрд░ рдЕрдкрдиреЗ рдкрд╛рдпрдерди рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛ рдЕрджреНрдпрддрд┐рдд рд░рдЦреЗрдВред рдирд┐рдГрд╕рдВрджреЗрд╣, рдЗрдирдореЗрдВ рд╕реЗ рдХрд┐рд╕реА рднреА рдЙрдкрдХрд░рдг рдХрд╛ рдкреНрд░рднрд╛рд╡реА рдврдВрдЧ рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдПрдХ рдЕрдЪреНрдЫреЗ рдХрдВрдкреНрдпреВрдЯрд░ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА!
```
~~ЁЯУБ `main.py` ЁЯСЖ тЬФя╕П **я╝жя╜Бя╜Уя╜Фя╝бя╝░я╝йя╝Ия╜Гя╝Ия╝┤я╝ня╝Йя╝Й** ЁЯУ▒~~
тФЬтФАтФА app
тФВ┬а┬а тФЬтФАтФА __init__.py
тФВ┬а┬а тФФтФАтФА main.py

{!../../../docs_src/app_testing/main.py!}
```

### ЁЯФм ЁЯУБ a0c92ce68e76f2489fba681312715614

``` hl_lines="5"
.
тФЬтФАтФА app
тФВ┬а┬а тФЬтФАтФА __init__.py
тФВ┬а┬а тФЬтФАтФА main.py
тФВ┬а┬а тФФтФАтФА test_main.py
```

#### ЁЯУж `app` тЮбя╕П `main` ЁЯХ╣ (`main.py`):

```Python hl_lines="3"
{!../../../docs_src/app_testing/test_main.py!}
```

#### ЁЯФмтЖФЁЯЦ╝

ЁЯУ║ ш┐Щф╕кчиЛх║Пх░ЖцИСцЙАцЬЙчЪДшпЭч┐╗шпСцИРшбицГЕчмжхП╖уАВх╛ИщЕ╖хРзя╝ЯхжВцЮЬцВиш╡ЮхКйцИСчЪДхЖЕхо╣я╝МщВгх░▒хдкщЕ╖ф║Жя╝БЁЯНХ

`x-token`

 "ЁЯРН 3я╕ПтГг.6я╕ПтГг &amp; ЁЯФЫ"

    ```Python
    {!> ../../../docs_src/app_testing/app_b/main.py!}
    ```

 "ЁЯРН 3я╕ПтГг.1я╕ПтГг0я╕ПтГг &amp; ЁЯФЫ"

    ```Python
    {!> ../../../docs_src/app_testing/app_b_py310/main.py!}
    ```

#### тЖФ ЁЯФм ЁЯУБ

ЁЯСЖ ЁЯТк тд┤я╕П тД╣ `test_main.py` тПоя╕П тЖФ ЁЯТп:

```Python
{!> ../../../docs_src/app_testing/app_b/test_main.py!}
```

**a7bcf86af3f7193137f95345d2afb7e4**

ЁЯд╢тУВ:
~~тЪля╕ПЁЯУЫтЪля╕П~~
╨Я╨╡╤А╨╡╨╣╨┤╨╕╤В╨╡ ╨║╨╛ ╨▓╤Б╨╡╨╝ ╤Н╤В╨╕╨╝ ╤А╨░╤Б╤И╨╕╤А╨╡╨╜╨╕╤П╨╝. ╨Я╤А╨╛╨▓╨╡╤А╤М╤В╨╡, ╨┐╤А╨░╨▓╨╕╨╗╤М╨╜╨░╤П ╨╗╨╕ ╤Н╤В╨╛ ╨▓╨╡╤А╤Б╨╕╤П. ╨Я╨╛╤Б╨╡╤В╨╕╤В╨╡ ╨╕ ╨┐╤А╨╛╤З╤В╨╕╤В╨╡ ╨г╤Б╨╗╨╛╨▓╨╕╤П ╨╛╨▒╤Б╨╗╤Г╨╢╨╕╨▓╨░╨╜╨╕╤П ╨╕ ╨б╨╛╨│╨╗╨░╤И╨╡╨╜╨╕╤П. ╨Ы╨╕╤Ж╨╡╨╜╨╖╨╕╨╛╨╜╨╜╨░╤П ╨╕╨╜╤Д╨╛╤А╨╝╨░╤Ж╨╕╤П ╨▓╤Б╤П ╨┤╨╛╤Б╤В╤Г╨┐╨╜╨░. ╨Т╤Б╨╡ ╤Н╤В╨╕ ╨┐╤А╨╛╨│╤А╨░╨╝╨╝╤Л ╤А╨░╨╖╤А╨░╨▒╨╛╤В╨░╨╜╤Л Python. ╨Р ╨▒╤Л╤Б╤В╤А╤Л╨╣ ╨╕╨╜╤В╨╡╤А╤Д╨╡╨╣╤Б ╨┐╤А╨╛╨│╤А╨░╨╝╨╝╨╕╤А╨╛╨▓╨░╨╜╨╕╤П ╨┐╤А╨╕╨╗╨╛╨╢╨╡╨╜╨╕╨╣ ╨▓╨╛ ╨╝╨╜╨╛╨│╨╛╨╝ ╨╖╨░╨▓╨╕╤Б╨╕╤В ╨╛╤В ╤Н╤В╨╕╤Е ╤Б╤В╨╛╤А╨╛╨╜╨╜╨╕╤Е ╤А╨░╤Б╤И╨╕╤А╨╡╨╜╨╕╨╣.

(тЪЩя╕П `httpx` тЪЦя╕П `TestClient`) тЬЕ <a href="https://www.python-httpx.org" class="external-link" target="_blank">┘Е┘Б╪к╪з╪н ┘И┘Г┘К┘Д ╪и╪▒┘И╪к┘И┘Г┘И┘Д ┘Ж┘В┘Д ╪з┘Д┘Ж╪╡ ╪з┘Д╪к╪┤╪╣╪и┘К. ┘З╪░╪з ╪╣┘Е┘К┘Д ╪з╪о╪к╪и╪з╪▒.</a>.

щЗНшжБчЪД
    
ЁЯШЭтЩЯя╜Бя╝дтЮГтЭ╢я╝Ця╝ЧтЭ╗хМЪ╩ШтУТтЭ║ЁЭУлтЮДя╝Ря╝СтЮЖтЮЖтУХс╡И╤▓тЭ╛тЮАтЮА╬▒ф╣Зя╝УтЮДя╝Ш╧Вя╝Ц╤Фф╣ГтЩзтШЮЁЯФм [щЯ│це╜уАВуГХуВбуВдуГлуАВцХ░хнЧ](encoder.md){.internal-link target=_blank}.

![blackhat](https://github.com/TheProdigyLeague/TheProblemsWithAPIs/assets/30985576/32102bc8-c11f-4ff2-a033-bcd3ceabeeeb)

~~тПоя╕П ЁЯСИ, ЁЯСЖ ЁЯТк тЭО `pytest`:~~

<div class="termy">

```console
$ pip install pytest

---> 100%
```

</div>

тЪля╕П ЁЯФЬ ЁЯФН ЁЯУБ &amp; ЁЯТп ЁЯФБ, ЁЯЫая╕П ЁЯСл, &amp; ЁЯУД ЁЯПБ ЁЯФЩ ЁЯСЖ.

ЁЯПГ ЁЯТп тПоя╕П:

<div class="termy">

```console
$ pytest

= test session starts =
platform linux -- Python 3.6.9, pytest-5.3.5, py-1.8.1, pluggy-0.13.1
rootdir: /home/user/code/superawesome-cli/app
plugins: forked-1.1.3, xdist-1.31.0, cov-2.8.1
collected 6 items

---> 100%

test_main.py <span style="color: green; white-space: pre;">......                            [100%]</span>

<span style="color: green;">== 1 passed in 0.03s ==</span>
```

</div>
-- eof --
